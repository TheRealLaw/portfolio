---
import Layout from "../layouts/Layout.astro";
import GalleryCard from "../components/GalleryCard.astro";
import fs from "node:fs";
import nodePath from "node:path";
import ExifReader from "exifreader";

// Get all cover images
const covers = import.meta.glob(
    "/src/content/portfolio/styles/*/cover.{jpg,png,jpeg,webp}",
    { eager: true },
);

// Process into a list of collections
const collections = Object.keys(covers)
    .map((filePath) => {
        const parts = filePath.split("/");
        const name = parts[5]; // portfolio/styles/[name]/cover
        const coverModule = covers[filePath] as any;
        const image = coverModule.default || coverModule;

        return {
            name,
            href: `/portfolio/${encodeURIComponent(name)}`,
            image,
            path: filePath,
        };
    })
    .sort();
---

<Layout title="Styles | Leo Wuellner">
    <div class="max-w-7xl mx-auto px-6 md:px-12 py-12">
        <h1
            class="text-4xl font-bold uppercase tracking-widest mb-12 text-center"
        >
            Styles
        </h1>

        <div class="columns-1 md:columns-2 lg:columns-3 gap-8 space-y-8">
            {
                collections.map((collection) => (
                    <div class="break-inside-avoid">
                        <GalleryCard
                            title={collection.name}
                            coverImage={collection.image}
                            href={collection.href}
                            objectPosition={
                                collection.name === "long exposure"
                                    ? "object-left"
                                    : undefined
                            }
                        />
                    </div>
                ))
            }
        </div>

        <!-- Keeping the original style guide below as a reference? Or should it be removed? similar request implies User just wants these galleries here. I will remove the style guide for now to be clean, or push it down. 
        I'll keep it as a "Reference" section at the bottom so I don't delete user's 'styles' page context entirely if that's what they wanted. But "add them to the styles page" usually means "make this the styles gallery page".
        I'll replace the content with the galleries. -->
    </div>
</Layout>
