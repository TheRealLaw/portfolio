---
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";

interface Props {
  title: string;
  href: string;
  coverImage: ImageMetadata | string; // Accept string path or imported image
  aspectRatio?: "auto" | "square";
  objectPosition?: string;
}

const { title, href, coverImage, aspectRatio = "auto" } = Astro.props;

// Helper to determine if coverImage is a string path or ImageMetadata
// Helper to determine if coverImage is a string path or ImageMetadata
const isStringPath = typeof coverImage === "string";
const imgSrc = coverImage
  ? isStringPath
    ? (coverImage as string)
    : (coverImage as ImageMetadata).src
  : ""; // Fallback or empty
---

<a href={href} class="group block relative mb-6 break-inside-avoid">
  <div
    class={`relative overflow-hidden bg-gray-100 ${aspectRatio === "square" ? "aspect-square" : ""}`}
  >
    {
      imgSrc && (
        <img
          src={imgSrc}
          alt={title}
          class={`w-full block transition-opacity duration-500 group-hover:opacity-90 ${aspectRatio === "square" ? `h-full object-cover ${Astro.props.objectPosition || ""}` : "h-auto"}`}
        />
      )
    }
    {
      !imgSrc && (
        <div class="w-full h-64 flex items-center justify-center text-gray-400">
          No Cover Image
        </div>
      )
    }
  </div>

  <div
    class="absolute inset-0 flex items-center justify-center bg-black/30 md:bg-black/0 group-hover:bg-black/40 md:group-hover:bg-black/10 transition-colors duration-300 p-4"
  >
    <h2
      class="text-white text-center text-xl md:text-2xl font-bold uppercase tracking-widest opacity-100 md:opacity-0 translate-y-0 md:translate-y-4 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300 drop-shadow-md"
    >
      {title}
    </h2>
  </div>
</a>
